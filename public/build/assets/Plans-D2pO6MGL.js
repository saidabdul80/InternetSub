import{d as H,B as q,z as f,k as J,C as K,g as p,w as n,e as l,b as s,u as t,h as O,j as w,o as r,i as d,t as c,a as _,F as P,r as N,D as Q,p as W}from"./app-Bbpl4-Pg.js";import{_ as $}from"./index-Dv5PaFr3.js";import{_ as F,a as D,b as V,c as j}from"./CardTitle.vue_vue_type_script_setup_true_lang-l__BwdJv.js";import{_ as X,a as Y,b as Z,c as ee,d as se}from"./DialogTitle.vue_vue_type_script_setup_true_lang-0wNaKQGi.js";import{_ as te}from"./DialogFooter.vue_vue_type_script_setup_true_lang-BqOgQKbF.js";import{_ as oe}from"./Input.vue_vue_type_script_setup_true_lang-DgBk5nx3.js";import{_ as M}from"./Label.vue_vue_type_script_setup_true_lang-DGQuHlNa.js";import{_ as B}from"./Spinner.vue_vue_type_script_setup_true_lang-D_4jQvSf.js";import{_ as E}from"./InputError.vue_vue_type_script_setup_true_lang-CJkTgDcg.js";import{_ as ae}from"./PortalLayout.vue_vue_type_script_setup_true_lang-DCdRu8Rf.js";import"./useForwardPropsEmits-ngj2cdvz.js";import"./x-CokJGW2T.js";import"./useForwardExpose-Bge-8bB2.js";import"./index-BcwGYDmr.js";import"./AppShell.vue_vue_type_script_setup_true_lang-DmzT6-Oi.js";import"./createLucideIcon-l49pqt4w.js";const ne={class:"flex flex-col gap-8"},le={class:"font-medium text-foreground"},re={class:"text-muted-foreground"},ie={class:"grid gap-6 md:grid-cols-2 xl:grid-cols-3"},ue={class:"text-3xl font-semibold text-foreground"},de={class:"flex flex-col gap-2 text-sm text-muted-foreground"},ce={class:"flex items-center justify-between"},me={class:"font-medium text-foreground"},fe={class:"flex items-center justify-between"},pe={class:"font-medium text-foreground"},ge={class:"flex items-center justify-between"},xe={class:"font-medium text-foreground"},ve={class:"mt-auto"},_e={class:"grid gap-4"},be={class:"grid gap-2"},he={class:"grid gap-2"},we={class:"flex flex-wrap gap-2"},ye={key:0,class:"text-xs text-muted-foreground"},ke={key:1,class:"text-xs text-muted-foreground"},$e={key:2,class:"text-xs text-muted-foreground"},Re=H({__name:"Plans",props:{plans:{},activeSubscription:{}},setup(g){const T=q().props.auth?.user,u=f(null),b=f(!1),m=f(null),i=J({login:"",password:""}),x=f([]),v=f(null),h=f(!1);let y;const G=o=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:0}).format(o/100),U=o=>o>=1440?`${Math.round(o/1440)} day(s)`:o>=60?`${Math.round(o/60)} hour(s)`:`${o} min(s)`,A=(o,e)=>{if(u.value=o,e){W.post(`/plans/${o}/checkout`,e,{onFinish:()=>{u.value=null}});return}i.post(`/plans/${o}/checkout`,{onFinish:()=>{u.value=null}})},z=o=>{if(T){A(o,{});return}m.value=o,b.value=!0},I=()=>{m.value!==null&&(u.value=m.value,i.post(`/plans/${m.value}/checkout`,{onSuccess:()=>{b.value=!1},onFinish:()=>{u.value=null}}))},L=/^(?:\+234|0)(7|8|9)\d{9}$/,R=o=>{const e=o.replace(/\D/g,"");return[e.slice(0,4),e.slice(4,8),e.slice(8,11)].map(k=>{const C=k.slice(-3),S=String.fromCharCode(65+Math.floor(Math.random()*26));return Math.random()>.5?`${S}${C}`:`${C}${S}`})};return K(()=>i.login,o=>{i.password="",L.test(o)?(window.clearTimeout(y),h.value=!0,y=window.setTimeout(async()=>{try{const a=await(await fetch(`/plans/phone-check?phone=${encodeURIComponent(o)}`)).json();v.value=!!a.exists}catch{v.value=null}finally{h.value=!1}v.value?x.value=[]:x.value=R(o)},300)):(x.value=[],v.value=null,window.clearTimeout(y))}),(o,e)=>(r(),p(ae,null,{default:n(()=>[l(t(O),{title:"Plans"}),s("div",ne,[e[8]||(e[8]=s("section",{class:"relative overflow-hidden rounded-2xl border border-border bg-gradient-to-br from-amber-50 via-white to-sky-50 p-6 md:p-8"},[s("div",{class:"absolute -right-16 -top-16 h-40 w-40 rounded-full bg-amber-200/40 blur-3xl"}),s("div",{class:"absolute -left-10 bottom-0 h-28 w-28 rounded-full bg-sky-200/50 blur-3xl"}),s("div",{class:"relative flex flex-col gap-4 md:max-w-2xl"},[s("span",{class:"text-xs font-semibold uppercase tracking-[0.2em] text-amber-700/80"}," Instant Hotspot Access "),s("h1",{class:"text-3xl font-semibold text-foreground md:text-4xl"}," Pick a plan and get online in minutes. "),s("p",{class:"text-sm text-muted-foreground"}," Choose a plan below, pay, and you are connected. "),s("div",{class:"flex flex-wrap gap-2 text-xs text-muted-foreground"},[s("div",{class:"rounded-full border border-amber-200 bg-white px-3 py-1"}," Paystack secure "),s("div",{class:"rounded-full border border-sky-200 bg-white px-3 py-1"}," Auto-login ")])])],-1)),g.activeSubscription?(r(),p(t(F),{key:0,class:"border-primary/40"},{default:n(()=>[l(t(D),null,{default:n(()=>[l(t(V),null,{default:n(()=>[...e[2]||(e[2]=[d("Active plan",-1)])]),_:1})]),_:1}),l(t(j),{class:"flex flex-col gap-2 text-sm"},{default:n(()=>[s("div",le,c(g.activeSubscription.plan.name),1),s("div",re," Expires: "+c(g.activeSubscription.expires_at?new Date(g.activeSubscription.expires_at).toLocaleString():"Not set"),1)]),_:1})]),_:1})):w("",!0),s("div",ie,[(r(!0),_(P,null,N(g.plans,a=>(r(),p(t(F),{key:a.id,class:"group relative flex flex-col justify-between overflow-hidden border border-border bg-white shadow-sm transition-all hover:-translate-y-1 hover:shadow-md"},{default:n(()=>[e[7]||(e[7]=s("div",{class:"pointer-events-none absolute inset-0 rounded-lg bg-gradient-to-br from-amber-50/70 via-white to-sky-50/70 opacity-0 transition-opacity duration-300 group-hover:opacity-100"},null,-1)),l(t(D),null,{default:n(()=>[l(t(V),{class:"relative text-xl"},{default:n(()=>[d(c(a.name),1)]),_:2},1024)]),_:2},1024),l(t(j),{class:"relative flex flex-1 flex-col gap-4"},{default:n(()=>[s("div",ue,c(G(a.price_kobo)),1),s("div",de,[s("div",ce,[e[3]||(e[3]=s("span",null,"Speed",-1)),s("span",me,c(a.speed_mbps)+" Mbps",1)]),s("div",fe,[e[4]||(e[4]=s("span",null,"Duration",-1)),s("span",pe,c(U(a.duration_minutes)),1)]),s("div",ge,[e[5]||(e[5]=s("span",null,"Profile",-1)),s("span",xe,c(a.mikrotik_profile),1)])]),s("div",ve,[l(t($),{class:"w-full",disabled:u.value===a.id,onClick:k=>z(a.id)},{default:n(()=>[u.value===a.id?(r(),p(t(B),{key:0})):w("",!0),e[6]||(e[6]=d(" Subscribe ",-1))]),_:2},1032,["disabled","onClick"])])]),_:2},1024)]),_:2},1024))),128))])]),l(t(X),{open:b.value,"onUpdate:open":e[1]||(e[1]=a=>b.value=a)},{default:n(()=>[l(t(Y),{class:"sm:max-w-lg"},{default:n(()=>[l(t(Z),null,{default:n(()=>[l(t(ee),{class:"text-sky-800"},{default:n(()=>[...e[9]||(e[9]=[d("Continue without logging in",-1)])]),_:1}),l(t(se),null,{default:n(()=>[...e[10]||(e[10]=[d(" Enter your phone number and pick a 4-character passcode. ",-1)])]),_:1})]),_:1}),s("div",_e,[s("div",be,[l(t(M),{for:"guest-login"},{default:n(()=>[...e[11]||(e[11]=[d("Phone number",-1)])]),_:1}),l(t(oe),{id:"guest-login",type:"text",modelValue:t(i).login,"onUpdate:modelValue":e[0]||(e[0]=a=>t(i).login=a),placeholder:"08012345678"},null,8,["modelValue"]),l(E,{message:t(i).errors.login},null,8,["message"])]),s("div",he,[l(t(M),null,{default:n(()=>[...e[12]||(e[12]=[d("Suggested passcodes",-1)])]),_:1}),s("div",we,[(r(!0),_(P,null,N(x.value,a=>(r(),p(t($),{key:a,type:"button",variant:"secondary",class:Q(["cursor-pointer hover:bg-sky-600 hover:text-white",a===t(i).password?"bg-sky-200 text-sky-950 font-semibold ":""]),onClick:k=>t(i).password=a},{default:n(()=>[d(c(a),1)]),_:2},1032,["class","onClick"]))),128)),h.value?(r(),_("span",ye," Checking phone number... ")):v.value?(r(),_("span",ke," Existing user detected. No new passcode needed. ")):x.value.length===0?(r(),_("span",$e," Enter a valid phone number to see suggestions. ")):w("",!0)]),l(E,{message:t(i).errors.password},null,8,["message"])])]),l(t(te),{class:"mt-4"},{default:n(()=>[l(t($),{class:"cursor-pointer",disabled:m.value===null||h.value||u.value===m.value,onClick:I},{default:n(()=>[u.value===m.value?(r(),p(t(B),{key:0})):w("",!0),e[13]||(e[13]=d(" Continue to payment ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1}))}});export{Re as default};
